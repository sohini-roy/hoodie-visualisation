<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Hoodie Visualisation</title>
    <link rel="stylesheet" href="index.css">
  </head>
  <body>
    <script type="text/javascript" src='jquery.js'></script>
    <script type="text/javascript">
    function getrepo(){
      var token = "7467572195c4052de5a018fd339990160d011504"
      var repoDummyPromises = []
      var repolist = [
      {
        name : "hoodie",
        url : "hoodiehq/hoodie"
      },
      {
        name : "camp",
        url : "hoodiehq/camp"
      },
      {
        name : "hoodie-server",
        url : "hoodiehq/hoodie-server"
      },
      {
        name : "hoodie-app-tracker",
        url : "hoodiehq/hoodie-app-tracker"
      },
      {
        name : "hoodie-client",
        url : "hoodiehq/hoodie-client"
      },
      {
        name : "hoodie-admin",
        url : "hoodiehq/hoodie-admin"
      }
      ]
      for(var i=0;i<repolist.length;i++){
        var repoDummy = $.ajax({
          url : "https://api.github.com/repos/" + repolist[i].url + "/issues?access_token"+token,
          method : 'GET'
        })
        repoDummyPromises.push(repoDummy);
      }
      $.when.apply($,repoDummyPromises).then(function(){
        var repos = [];
        var dummyLabelDictionary = {};
        for(var i=0;i<repolist.length;i++){
          repos.push({name : repolist[i].name,issues : arguments[i][0]});
        }
        for(var i=0;i <repos.length;i++){
          var repo_issues = repos[i].issues
          // console.log(repos[i].issues);
          // console.log(repo_issues);
          for(var j= 0;j<repo_issues.length;j++){
            var repo_issues_label = repos[i].issues[j].labels
            // console.log(repos[i].issues[j].labels);
            // console.log(repo_issues_label);
            for(var k=0;k<repo_issues_label.length;k++){
              var repo_issues_labeldummy = repos[i].issues[j].labels[k]
              // console.log(repos[i].issues[j].labels[k].name)
              // console.log(repo_issues_labeldummy);
              if(dummyLabelDictionary[repo_issues_labeldummy.name]){
                dummyLabelDictionary[repo_issues_labeldummy.name] += 1;
              }
              else{
                dummyLabelDictionary[repo_issues_labeldummy.name] = 1;
              }
            }
          }
          repos[i]['labelDictionary'] = dummyLabelDictionary;
        }
        console.log(repos);
      })
    }

    getrepo();
    </script>
  </body>
</html>
